---
import Layout from "@/layouts/Layout.astro";
import Categories from "../components/astro/Categories.astro";
import HeroSection from "@/components/astro/HeroSection.astro";
import PageHeader from "@/components/astro/PageHeader.astro";
import SearchFilter from "@/components/vue/SearchFilter.vue";
import ListingSection from "@/components/astro/ListingSection.astro";
import bgHeader from "@/assets/images/bg-hero.jpg";
import { actions } from "astro:actions";
import { astroCalledServerError } from "astro:actions";

// test properties
const {data, error}= await Astro.callAction(actions.getPropertiesByPage, { limit: 4 });

const properties = data?.properties ?? [];

if(error){
  console.log("Error fetching properties:", error);
} else {
  // console.log("Fetched properties:", properties);
}


// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout>
 <PageHeader
  image={bgHeader.src}
  title="Encuentra tu hogar"
  subtitle="Descubre las mejores propiedades disponibles"
>
  <!-- Todo lo que pongas aquÃ­ reemplaza el slot -->
  <SearchFilter client:load />
</PageHeader>
  <Categories />
  <ListingSection propertiesData={properties}/>
  <HeroSection />
  <ListingSection  propertiesData={properties} limit={8}  />
  <!-- <Featured /> -->
  
</Layout>
